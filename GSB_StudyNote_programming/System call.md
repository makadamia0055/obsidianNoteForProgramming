---
tags:
  - OS
  - cpu
aliases:
  - System call
  - 시스템 콜
---
# System call란?
- 시스템 콜이란 [[OS|운영체제]]와 응용 프로그램 간의 인터페이스로, 응용 프로그램이 운영체제의 기능을 활용하거나 하드웨어 자원에 접근하기 위해 사용하는 메커니즘이다.
- 시스템 콜은 [[Operating System Kernel|운영체제 커널]]에 의해 제공되며, 응용 프로그램은 시스템 콜을 호출하여 특정 작업을 수행하거나 리소스에 접근할 수 있다.
![[인터페이스로서 시스템 콜.png]]
- [[CPU Modes|CPU 모드]] 모델에 따라, 사용자 응용 프로그램은 사용자 모드라는 제약된 권한 계층을 가진다. 
	- 사용자 모드에서 응용 프로그램은 자체 주소 공간 내로 작업 범위가 제약되며, 다른 프로그램 및 운영체제 자체에 직접적으로 액세스 할 수 없다.
- 사용자 응용 프로그램에서 이렇게 사용자 모드로는 금지된 작업을 수행할 필요가 있을 때, 시스템 콜 인터페이스를 통해 [[Operating System Kernel|운영체제 커널]]로 해당 작업을 위임한다. 
	- 이를 보다 자세히 정리하면 다음과 같다.
		1. 유저 모드에서의 실행 
			-  프로세스가 일반적인 사용자 모드에서 실행 중일 때, 프로세스는 제한된 권한으로만 동작. 특권 명령이나 시스템 자원에 직접 접근하는 것이 허용되지 않음.
		2. 커널 모드로의 전환:
			- 프로세스가 시스템 호출(System Call)을 하게 되면, 운영체제의 커널이 필요한 작업을 수행하기 위해 해당 프로세스 대신에 커널 모드로 전환됨. 이때, [[CPU]]의 상태가 커널 모드로 바뀌게 됩니다.
		3. 커널에서의 작업 수행
			- 커널 모드에서는 운영체제의 핵심 부분이 실행되며, 특권 명령이나 시스템 자원에 직접적으로 접근할 수 있음. 이 단계에서 시스템 호출에 필요한 작업을 수행함.
		4. 결과 반환 및 유저 모드로의 복귀
			- 커널에서의 작업이 완료되면, 결과가 유저 모드의 프로세스에게 반환되고, 다시 유저 모드에서의 실행이 계속됨.
	- 상기의 과정을 모드 전환이라고 표현하는데, 이때 전환되는 것은 프로세스의 모드가 아니라 CPU의 상태이다. 
		- 사용자 프로세스는 커널 스레드에 특정 시스템 콜을 위임한다.
		- [[CPU]]의 [[플래그 레지스터]] 속 [[슈퍼바이저 플래그]]가 현재 CPU의 모드가 커널 모드인지, 사용자 모드인지를 나타낸다.
- 시스템 콜은 일종의 [[Interrupt]]로, 소프트웨어적인 [[Interrupt]]이다.
	- 때문에 [[CPU]]가 시스템 콜을 처리하는 루틴은 인터럽트 처리 루틴을 따른다. 
	- 시스템 콜을 발생시키는 명령어가 실행되면 CPU는 현재까지의 작업을 백업하고, 커널 영역 내에 시스템 호출을 수행하는 코드(인터럽트 서비스 루틴)을 실행한 뒤 다시 기존에 실행하던 응용 프로그램으로 복귀하여 실행을 계속해 나간다.

## 시스템 콜의 종류
- 시스템 콜은 프로세스 제어, 파일 조작, 디아비스 조작, 정보 유지, 통신, 보호 크게 6가지로 분류할 수 있다.
	1. 프로세스 제어(Process Control)
	2. 파일 조작(File Manipulation)
	3. 디바이스 조작(Device Manipulation)
	4. 정보 유지(Information Maintenance)
	5. 커뮤니케이션(Communication)
	6. 보호(Protection)
![[윈도우와 유닉스의 시스템 콜 종류.png]]

## 시스템 콜과 [[API]]
 - [[API]]는 [[System call|시스템 콜]]을 더 쉽게 사용할 수 있도록 추상화된 [[인터페이스]]를 제공한다. 
	- 이를 통해 프로그래머는 [[OS|운영체제]]의 내부 동작을 몰라도 원하는 작업을 수행할 수 있다. 
	- 현대의 [[OS|운영체제]]들은 해당 운영체제에서 사용할 수 있는 [[API]]를 제공한다.
- [[API]]를 사용하면 운영체제의 종류에 상관없이 동일한 코드를 유지할 수 있어서 프로그램의 이식성과 개발 편의성을 높일 수 있다. 
	- 최근에는 많은 프로그래밍 언어와 프레임워크가 API를 통해 시스템 콜을 추상화하고 제공하므로, 개발자들은 대부분 시스템 콜을 직접 다루지 않고 API를 사용한다.

## [[Java]]와 시스템 콜
- [[Java]]에서 시스템 콜을 요청할 때는 일반적으로 [[Java API]]를 사용하며, 이러한 API들은 내부적으로 [[네이티브 코드]]를 사용하여 시스템 콜을 요청한다.
	- [[Java]]는 플랫폼 독립적인 언어로 설계되었기 때문에, 직접적인 시스템 콜을 지원하지 않는다.
	- 대신 자바는 [[JNI|자바 네이티브 인터페이스]]라는 프레임워크를 제공하여, 자바 코드가 네이티브 응용 프로그램과 [[C 언어|C]], [[C++]], [[어샘블리]] 등의 다른 언어로 작성된 라이브러리를 호출하거나 반대로 호출 되는 것을 가능하게 한다.


## 레퍼런스
- [시스템 콜 (velog.io)](https://velog.io/@nyoung215/%EC%8B%9C%EC%8A%A4%ED%85%9C-%EC%BD%9C)
- [시스템 콜- 위키피디아](https://en.wikipedia.org/wiki/System_call)
- 혼공 컴구 운체
- GPT 4.0(Bing AI)
- [운영체제의 구조 - System call 에 대하여 (yevgnenll.me)](https://blog.yevgnenll.me/os/what-is-system-call)